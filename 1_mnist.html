<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Changelog" href="changelog.html" /><link rel="prev" title="AGN Approx" href="index.html" />
        <link rel="canonical" href="https://etrommer.github.io/agn-approx/1_mnist.html" />

    <link rel="shortcut icon" href="_static/agnapprox_icon.png"/><meta name="generator" content="sphinx-5.1.1, furo 2022.06.21"/>
        <title>Tutorial 1: Approximate MNIST - AGN Approx Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_paramlinks.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">AGN Approx Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="https://raw.githubusercontent.com/etrommer/agn-approx/main/docs/agnapprox_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">AGN Approx Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorial 1: Approximate MNIST</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="conduct.html">Code of Conduct</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="autoapi/agnapprox/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/agnapprox/datamodules/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.datamodules</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/datamodules/approx_datamodule/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.datamodules.approx_datamodule</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/datamodules/cifar10/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.datamodules.cifar10</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/datamodules/format_tinyimagenet/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.datamodules.format_tinyimagenet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/datamodules/mnist/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.datamodules.mnist</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/datamodules/tinyimagenet200/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.datamodules.tinyimagenet200</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/agnapprox/nets/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="autoapi/agnapprox/nets/base/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.base</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="autoapi/agnapprox/nets/base/lenet5/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.base.lenet5</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="autoapi/agnapprox/nets/base/resnet/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.base.resnet</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/nets/alexnet/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.alexnet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/nets/approxnet/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.approxnet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/nets/lenet5/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.lenet5</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/nets/mobilenetv2/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.mobilenetv2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/nets/resnet/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.resnet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/nets/vgg/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.nets.vgg</span></code></a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="autoapi/agnapprox/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/utils/error_stats/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.utils.error_stats</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/utils/model/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.utils.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="autoapi/agnapprox/utils/select_multipliers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.utils.select_multipliers</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="autoapi/agnapprox/agnapprox/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">agnapprox.agnapprox</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="tutorial-1-approximate-mnist">
<h1>Tutorial 1: Approximate MNIST<a class="headerlink" href="#tutorial-1-approximate-mnist" title="Permalink to this heading">#</a></h1>
<p>This notebook will walk you through the steps required to train a simple CNN on the MNIST dataset while determining the robustness to additive Gaussian noise.</p>
<p><code class="docutils literal notranslate"><span class="pre">agnapprox</span></code> already comes with predefined implementations for an MNIST dataset loader as well as <a class="reference external" href="https://en.wikipedia.org/wiki/LeNet">LeNet5</a> which we will use in this tutorial. The next tutorial will show you how to define your own architecture.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">agnapprox.nets</span> <span class="kn">import</span> <span class="n">LeNet5</span>
<span class="kn">from</span> <span class="nn">agnapprox.datamodules</span> <span class="kn">import</span> <span class="n">MNIST</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CUDA not found, running on CPU
</pre></div>
</div>
</div>
</div>
<p>We first set up the datamodule. Downloaded datasets are written to the path pointed to by the environment variable <code class="docutils literal notranslate"><span class="pre">AGNAPPROX_DATA_DIR</span></code> by default. If the variable is not set, the subdirectory <code class="docutils literal notranslate"><span class="pre">data</span></code> is created locally.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dm</span> <span class="o">=</span> <span class="n">MNIST</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">dm</span><span class="o">.</span><span class="n">prepare_data</span><span class="p">()</span>
<span class="n">dm</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we define the model. We can simply instantiate the appropriate <code class="docutils literal notranslate"><span class="pre">agnapprox</span></code> wrapper without anything else.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LeNet5</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="model-training">
<h2>Model Training<a class="headerlink" href="#model-training" title="Permalink to this heading">#</a></h2>
<p>Every <code class="docutils literal notranslate"><span class="pre">agnapprox</span></code> network has four modes in which the network can be trained:</p>
<ol class="arabic simple">
<li><p><strong>Baseline</strong>: Train an FP32 baseline model without quantization, approximation, AGN, etc.</p></li>
<li><p><strong>Quantization-aware Training</strong>: Apply quantization during the forward pass. Also known as <em>quantization-aware training</em></p></li>
<li><p><strong>Gradient Search</strong>: Add Gaussian noise to the output of each target operation. The amount of noise injected in each layer is passed to the optimizer and optimized together with the other network parameters.</p></li>
<li><p><strong>Approximate Retraining</strong>: Use Lookup tables of approximate multipliers to retrain the network in order to minimize the loss of accuracy when deploying approximate multipliers</p></li>
</ol>
<p>Normally, you would train a model in every mode in the order given above (but feel free to experiment with other setups!). <code class="docutils literal notranslate"><span class="pre">agnapprox</span></code> network instances provide training functions for each mode with some added functionality. The training functions are wrappers around <code class="docutils literal notranslate"><span class="pre">pytorch-lightning</span></code>’s <code class="docutils literal notranslate"><span class="pre">Trainer()</span></code> API and extra arguments can be passed to the <code class="docutils literal notranslate"><span class="pre">fit()</span></code> method if desired.</p>
<p>We will start with a simple FP32 baseline model. The default number of epochs for each stage is defined in the network wrapper file, but it can be overridden by passing <code class="docutils literal notranslate"><span class="pre">epochs=</span></code> to the training function. Here, we will train for 8 epochs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">train_baseline</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: False, used: False
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TPU available: False, using: 0 TPU cores
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IPU available: False, using: 0 IPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  | Name  | Type   | Params
---------------------------------
0 | model | LeNet5 | 61.9 K
---------------------------------
61.9 K    Trainable params
0         Non-trainable params
61.9 K    Total params
0.248     Total estimated model params size (MB)
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "4da7916b82d34c79bdb7c27fd57e83b7"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "052485f85f71467bb2a9efc8bc4792d2"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "8efdd022fa0644b79ce3597698fe0b6a"}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/elias/agn-approx/.venv/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py:653: UserWarning: Detected KeyboardInterrupt, attempting graceful shutdown...
  rank_zero_warn(&quot;Detected KeyboardInterrupt, attempting graceful shutdown...&quot;)
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "4494287c98374d57b6b226698892bb2b"}</script></div>
</div>
<p>Next, we optimze the model for 8-Bit quantization using the <code class="docutils literal notranslate"><span class="pre">train_quant</span></code> functions. If you are wondering where the training hyperparameters like optimizer, learning rate, learning rate schedule etc. are coming from: They are also pre-defined in the network’s definition.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">train_quant</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs

  | Name  | Type   | Params
---------------------------------
0 | model | LeNet5 | 61.9 K
---------------------------------
61.9 K    Trainable params
0         Non-trainable params
61.9 K    Total params
0.248     Total estimated model params size (MB)
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cbdf6ad6afa64702b8b4051933c62afb", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8f74e654f57e403b9af5f385863f19dd", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "de20614fe2444954816f4346d782c500", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_epochs=1` reached.
</pre></div>
</div>
</div>
</div>
</section>
<section id="robustness-optimization">
<h2>Robustness Optimization<a class="headerlink" href="#robustness-optimization" title="Permalink to this heading">#</a></h2>
<p>Now comes the exciting part: We train while optimizing the amoung of AGN per layer. By passing <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> we get a debug output with the intermediate results after every epoch.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set appropriate log level and send to stdout so that logging output shows up in Jupyter</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">train_gradient</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">lmbd</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">initial_noise</span><span class="o">=</span><span class="mf">0.025</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs

  | Name  | Type   | Params
---------------------------------
0 | model | LeNet5 | 61.9 K
---------------------------------
61.9 K    Trainable params
0         Non-trainable params
61.9 K    Total params
0.248     Total estimated model params size (MB)
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "6d4a77f23c5c42f19ab7e458117137d9", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "e9303f2fc2bb496fa569c8aabc9225a3", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f5834429021d4f1c80d97def42220dcd", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:agnapprox.nets.approxnet:Epoch: 0
INFO:agnapprox.nets.approxnet:Layer: model.conv1.0 | sigma_l: +0.064
INFO:agnapprox.nets.approxnet:Layer: model.conv2.0 | sigma_l: +0.380
INFO:agnapprox.nets.approxnet:Layer: model.linear1 | sigma_l: +0.098
INFO:agnapprox.nets.approxnet:Layer: model.linear2 | sigma_l: +0.045
INFO:agnapprox.nets.approxnet:Layer: model.linear3 | sigma_l: +0.011
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "f8760ab806674e3f88e2a25915ee756a", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:agnapprox.nets.approxnet:Epoch: 1
INFO:agnapprox.nets.approxnet:Layer: model.conv1.0 | sigma_l: +0.065
INFO:agnapprox.nets.approxnet:Layer: model.conv2.0 | sigma_l: +0.491
INFO:agnapprox.nets.approxnet:Layer: model.linear1 | sigma_l: +0.103
INFO:agnapprox.nets.approxnet:Layer: model.linear2 | sigma_l: +0.049
INFO:agnapprox.nets.approxnet:Layer: model.linear3 | sigma_l: +0.014
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cec2b7fadeda4ef0aac65e76cfce2ff5", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:agnapprox.nets.approxnet:Epoch: 2
INFO:agnapprox.nets.approxnet:Layer: model.conv1.0 | sigma_l: +0.069
INFO:agnapprox.nets.approxnet:Layer: model.conv2.0 | sigma_l: +0.499
INFO:agnapprox.nets.approxnet:Layer: model.linear1 | sigma_l: +0.107
INFO:agnapprox.nets.approxnet:Layer: model.linear2 | sigma_l: +0.062
INFO:agnapprox.nets.approxnet:Layer: model.linear3 | sigma_l: -0.006
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_epochs=3` reached.
</pre></div>
</div>
</div>
</div>
</section>
<section id="multiplier-assignment">
<h2>Multiplier Assignment<a class="headerlink" href="#multiplier-assignment" title="Permalink to this heading">#</a></h2>
<p>Finally, we can use this information to assign matching multipliers to each layer.
This is done through a helper function that gets passed a list of approximate multipliers, from which the best-matching one is picked for each layer.</p>
<p>Each multiplier in the list should be a dataclass instance that looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">ApproximateMultiplier</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">performance_metric</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">error_map</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
</pre></div>
</div>
<p>For the parameter <code class="docutils literal notranslate"><span class="pre">performance_metric</span></code>, you can choose any property that you want to <strong>minimize</strong> across the your neural network. Normally, this would likely be things like power consumption, area usage, etc.</p>
<section id="error-map-construction">
<h3>Error Map Construction<a class="headerlink" href="#error-map-construction" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">error_map</span></code> is a numpy array of shape 256x256, where each entry corresponds to the difference between the accurate and the approximate result for <code class="docutils literal notranslate"><span class="pre">int8</span></code> operands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">error_map</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">([</span><span class="mi">256</span><span class="p">,</span><span class="mi">256</span><span class="p">])</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">):</span>
        <span class="n">error_map</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="mi">128</span><span class="p">][</span><span class="n">y</span><span class="o">+</span><span class="mi">128</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">approx_mult</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">approx_mult</span></code> is some approximate multiplication implementation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import a few helpers and a provider of approximate multipliers</span>
<span class="kn">from</span> <span class="nn">agnapprox.utils</span> <span class="kn">import</span> <span class="n">select_multipliers</span><span class="p">,</span> <span class="n">deploy_multipliers</span>
<span class="kn">from</span> <span class="nn">evoapproxlib</span> <span class="kn">import</span> <span class="n">EvoApproxLib</span>
<span class="kn">import</span> <span class="nn">pytorch_lightning</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">trainer</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Trainer</span><span class="p">()</span>
<span class="n">evo</span> <span class="o">=</span> <span class="n">EvoApproxLib</span><span class="p">()</span>
<span class="n">target_multipliers</span> <span class="o">=</span> <span class="n">evo</span><span class="o">.</span><span class="n">prepare</span><span class="p">(</span><span class="n">signed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tm</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">tm</span> <span class="ow">in</span> <span class="n">target_multipliers</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mul8s_1KR3, mul8s_1KR6, mul8s_1KR8, mul8s_1KRC, mul8s_1KTY, mul8s_1KV8, mul8s_1KVA, mul8s_1KVB, mul8s_1KVL, mul8s_1KX2, mul8s_1L1G, mul8s_1L2D, mul8s_1L2H
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Match multipliers to layers</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">select_multipliers</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">dm</span><span class="p">,</span> <span class="n">target_multipliers</span><span class="p">,</span> <span class="n">trainer</span>
<span class="p">)</span>
<span class="c1"># Deploy selected multipliers to each layer</span>
<span class="n">deploy_multipliers</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">evo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "db648b10202c4bad85ed5e01adea1ca3", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>INFO:agnapprox.utils.select_multipliers:Layer: model.conv1.0, Best Match: mul8s_1L2H, Performance: 0.301000, Relative Performance: 0.708235
INFO:agnapprox.utils.select_multipliers:Layer: model.conv2.0, Best Match: mul8s_1L1G, Performance: 0.126000, Relative Performance: 0.296471
INFO:agnapprox.utils.select_multipliers:Layer: model.linear1, Best Match: mul8s_1L2D, Performance: 0.200000, Relative Performance: 0.470588
INFO:agnapprox.utils.select_multipliers:Layer: model.linear2, Best Match: mul8s_1L2D, Performance: 0.200000, Relative Performance: 0.470588
INFO:agnapprox.utils.select_multipliers:Layer: model.linear3, Best Match: mul8s_1KX2, Performance: 0.391000, Relative Performance: 0.920000
</pre></div>
</div>
</div>
</div>
<p>If we look at some data, we see that the layer with the most multiplications gets assigned the hardware instance with the lowest energy consumption, while the first and last layers remain relatively accurate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">layers</span><span class="p">))</span>
<span class="n">multiplier_performance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">relative_energy_consumption</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">metric_max</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">layers</span><span class="p">])</span>
<span class="n">opcounts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">relative_opcount</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">opcount</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">layers</span><span class="p">])</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">layers</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">multiplier_performance</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative Energy Consumption&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">relative_energy_consumption</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">opcounts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Relative Opcount&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0f9a168337a55dab28cd1da6949e7953623e48dce320ead43ea913ed4bf81e6a.png" src="_images/0f9a168337a55dab28cd1da6949e7953623e48dce320ead43ea913ed4bf81e6a.png" />
</div>
</div>
</section>
</section>
<section id="approximate-retraining">
<h2>Approximate Retraining<a class="headerlink" href="#approximate-retraining" title="Permalink to this heading">#</a></h2>
<p>We have selected an approximate multiplier for each layer and deployed them. The last step is to retrain the network while simulating the selected approximate multipliers so that the network learns to compensate for the error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">train_approx</span><span class="p">(</span><span class="n">dm</span><span class="p">,</span> <span class="n">test</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GPU available: False, used: False
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs

  | Name  | Type   | Params
---------------------------------
0 | model | LeNet5 | 61.9 K
---------------------------------
61.9 K    Trainable params
0         Non-trainable params
61.9 K    Total params
0.248     Total estimated model params size (MB)
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7ee83253ccd145aabe7719eda971cd96", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "f43c7eb452914c9f8d500554ce52de4e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "22af0a8be6904c689e327b9547edd010", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "6970077b200548b7a00971b48d88e5c4", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "4c74ae0cc04740f19d412b2626aeb845", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "d00471dfd6984c0ba4470f761297f6d6", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "8d94abcb8e9140e39945b613de30d62a", "version_major": 2, "version_minor": 0}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`Trainer.fit` stopped: `max_epochs=5` reached.
</pre></div>
</div>
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "e8faa034ed974fbfbfa7012e79372e8c", "version_major": 2, "version_minor": 0}</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
      test_acc_top1         0.9915000200271606
        test_loss          0.031246893107891083
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
</pre></div>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Changelog</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Elias Trommer
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Tutorial 1: Approximate MNIST</a><ul>
<li><a class="reference internal" href="#model-training">Model Training</a></li>
<li><a class="reference internal" href="#robustness-optimization">Robustness Optimization</a></li>
<li><a class="reference internal" href="#multiplier-assignment">Multiplier Assignment</a><ul>
<li><a class="reference internal" href="#error-map-construction">Error Map Construction</a></li>
</ul>
</li>
<li><a class="reference internal" href="#approximate-retraining">Approximate Retraining</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    </body>
</html>